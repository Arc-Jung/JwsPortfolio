클라우드 서비스 문서
===========================================================================================
1. 클라우드 컴퓨팅의 정의
------------------------------------------------------------------------------------------
- 전체 프로젝트를 진행할때 배포의 중요성은 매우 높다. localhost에서 완성도가 높은 프로젝트를 만든다고 하여도 프로젝트가 배포 과정이 없다면 다른 사람들이 이 프로젝트를 외부에서 접근 할 수 없을 것이고 이것은 곧 출시되지 않는 것과 걑은 것이다. 이 문서에서는 배포 과정에 대해서 설명을 할 예정이다. 또한 구글의 전 CEO 였던 에릭 슈미츠는 아래와 같이 말하였다.
  
>데이터와 프로그램 모두 다 클라우드 속에 있으면 된다. 필요한 것은 브라우저와 인터넷에 대한 억세스 뿐이다. PC, 맥, 스마트폰 지금 손에 들고 있는 어떠한 단말기로도 접속하여 사용 할 수 있으며 모든 데이터와 데이터 처리는 클라우드 내부의 서버에서 처리한다. - Eric Emerson Schmidt

- 프로젝트의 목적 및 개요부터 클라우드 컴퓨팅에 배포를 예정으로 프로젝트를 설계해왔다. 그러므로 프로젝트의 배포는 꼭 해야한다고 계획하였다. 미국 국립표준기술연구(이하 NIST)의 정의에 따르면 클라우드 컴퓨팅은 '컴퓨터, 네트워크, 서버, 스토리지 , 애플리케이션, 서비스 등 구성 가능한 컴퓨팅 리소르의 공유 풀에 대해 편리하고 언제든지 억세스 할 수 있으며, 최소한의 관리 노력 또는 서비스 제공업체간의 상호 작동에 의해 신속하게 이용 할 수 있는 모델이다.' 라고 정의 하였다. NIST의 정의는 클라우드 컴퓨팅에 있어서 가장 중요하고 표준적인 정의가 되었다. 

<img src="https://raw.githubusercontent.com/dsg890789/JwsPortfolio/master/Django%20Framework%20Project/AWS%20GCP%20Azure%20Infographic.jpg">

- 2019년 현재 클라우드 컴퓨팅은 3개의 IT 공룡기업들의 점유율이 압도적이며 전세계 전체 점유율 50%의 아마존 웹 서비스와 기술력 기반의 전통의 강자 마이크로소프트의 Azure 그리고 알파고와 텐서플로우 등의 높은 인공지능 기술을 바탕으로 만든 구글의 Google Cloud Platform(이하 GCP)이 있다. 3가지 기업 중 마이크로 소프트가 시가 총액 1400조원에(2019년 12월 기준) 달하며 구굴의 지주회사인 알파벳의 시가총액 또한 약 1200조원에(2019년 12월 기준) 달하며 가장 적은 수치의 아마존도 약 500조원으로 국내의 가장 큰 기업인 삼성의 모든 계열사를 합친것 보다 최소 2배 이상 많다. 이러한 거대한 IT 공룡기업들은 공통적으로 자체 클라우드 컴퓨팅 솔루션을 가지고 있으며 앞으로의 IT 서비스의 대부분은 클라우드에서 설계 및 개발 그리고 배포 될 것이다. 향후 국내 및 국외 모두 클라우드 컴퓨팅 환경이 대세가 될 것 확실하고 글을 쓰는 2019년 12월 기준으로 이미 진행되고 있다. 그러므로 백석마켓은 설계 단계부터 기존의 온파라이미스 방식의 서버를 지양하고 클라우드 컴퓨팅을 통해서 100% 클라우드 서비스를 통하여 서비스 할 것을 철저히 설계하여 개발이 진행되었다.

1. 아마존 웹 서비스(이하 AWS) 선정 이유
------------------------------------------------------------------------------------------
- 아마존 웹 서비스(이하 AWS)의 선정이유는 다음과 같다.

        1. 가장 높은 글로벌 및 국내 점유율을 가지고 있다. 이 장점은 AWS를 이용함으로써 개발자에게 가장 넓은 인더스트리 풀을 제공해주는 것으로 프로젝트에 필요한 인력 공급에 있어 유연하게 대처 하도록 하였고 개발 도중 생기는 이슈사항에 대해서도 대처 가능하도록 안정성을 위하여 AWS를 선택하는 중요한 이유가 되었다.

        2. 국내에서 번역된 자료를 찾기 가장 쉽다. 첫번째 이유와 동일한 선상의 이야기지만 국내 개발자들의 클라우드 서비스 이용률은 AWS의 경험이 많으며 이는 곧 번역된 문서를 찾기 쉬워 학습 시간의 단축을 하고 개발시간을 단축 하였다.

        3. AWS 프리티어가 있다. AWS는 가입 후 1년동안 프리티어를 제공해준다. AWS 프리티어는 1년간 1개의 EC2 인스턴스와 1개의 RDS 인스턴스를 무료로 제공해준다. 이는 곧 프로젝트의 비용을 절감 할 수 있는 방법이라고 생각하여 선택하였다.

        4. 타플랫폼 대비 학습의 상승곡선이 가파르다. AWS의 메뉴얼은 대부분 번역되어 있으며 무료 이용자여도 업무시간 내에서라면 무료로 기술지원이 가능하다는 장점을 가지고 있어 선택하였다.

        5. 마지막으로 AWS에 AWS 클라우드9이 있기 때문이다. 개발자라면 누구나 개발환경세팅을 해본 적이 있을 것이다. 하지만 개발환경세팅은 쉬운 일이 아니다. 프로젝트 참여인원의 각각의 컴퓨터에서는 저마다 다른 운영체제와 API 버전, 다른 언어 버전 등 개발환경세팅을 방해할 요소가 굉장히 많다. 하지만 AWS의 클라우드9을 사용하면 인터넷이 사용가능한 모든 PC / Mac / Ubuntu / Android / iPad 등 운영체제와 하드웨어에 의존성 없이 개발에 참여하고 빌드 할 수 있으며 다른 사람이 편집하는 것 또한 실시간으로 볼 수 있는 강력한 통합개발환경을 구성할 수 있으므로 AWS를 선택하는 이유가 되었다.

1. AWS 사용 기술 스택 정의
------------------------------------------------------------------------------------------
    
    AWS RDS t2.micro With Oracle 12c Enterprise Edition -> 2020년 중 t3.micro로 유지보수 계획.
    AWS EC2 t2.micro -> 2020년 중 t3.micro로 유지보수 계획.
    AWS S3 Bucket
    AWS CloudWatch
    AWS Cloud9
    AWS EBS
    AWS S3
    AWS LoadBalance
    AWS IAM


4. AWS EC2 설정
------------------------------------------------------------------------------------------

<img src="https://raw.githubusercontent.com/dsg890789/JwsPortfolio/master/Django%20Framework%20Project/BuMarket%20AWS%20EC2_1.png">

- Amazon EC2는 Amazon Elastic Compute Cloud의 약자로 클라우드에서 확장식 컴퓨팅(오토스케일링)을 제공한다. 클라우드 컴퓨팅 이전의 온프레미스(On-premise) 방식은 IDC 또는 직장 내의 특정한 공간에 서버렉을 설치하여 그곳에 서버 장비들을 설치하는 방식이였다. 이 방식은 서버를 위한 인원을 배치해야 하고 서버에 필요한 하드웨어와 소프트웨어의 설치와 라우터 설정 등 수많은 절차가 있었고 기간은 짧게는 몇주에서 길게는 몇달에 이르기까지 수많은 시간과 비용과 인력이 소모되었다. 초기 투자 비용이 없는 소규모 프로젝트팀 또는 업체들은 이 비용이 큰 부담으로 다가왔고 서버 구성에 소극적으로 변하였다. 하지만 클라우드의 등장으로 소규모 프로젝트에서는 이러한 온프레미스 방식은 비선호 되었고, 클라우드를 다룰 수 있는 사람 1명만 있으면 간편하고 편리하게 서버를 구성할 수 있게 되었고 그 결과 폭발적인 스타트업 업체들이 생기게 되었다. 백석마켓또한 localhost에서 나와 클라우드를 통하여 실제 배포단계까지 구현할 수 있게 되었다.

- Amazon EC2의 자세한 성능 및 세팅은 다음과 같다.
        인스턴스 유형 : t2.micro
        시작 시간 : 2019년 11월 10일 오후 6시 42분 26초
        IPv4 퍼블릭 IP : 18.189.29.144
        vCPU : 1
        메모리 : 1GB
        

> vCPU는 클라우드 컴퓨팅 파워의 단위이다. 1vCPU는 최대 3.3GHz 인텔 확장 가능한 프로세서로 교육 목적의 프로젝트로는 충분한 성능이다.
  
1. AWS RDS 설정
------------------------------------------------------------------------------------------

<img src="https://raw.githubusercontent.com/dsg890789/JwsPortfolio/master/Django%20Framework%20Project/BuMarket%20AWS%20RDS%20Logo.png">

- Amazon RDS는 Amazon Relational Database Service의 약자로 CPU, 메모리, 스토리지 및 IOPS가 모두 한데 묶여 하나의 서비스로 구성하여 제공한다. RDS를 구성하게 되면 데이터 베이스를 단 몇분만에 구성이 가능하다. Amazon RDS는 백업, 소프트웨어 패치, 자동 장애 감지 및 복구를 관리하며 사용자의 설정에 따라 RDS의 로그를 AWS의 범용 스토리지인 S3에 저장을 할 수 있다.

- 백석마켓에서는 t3.micro 인스턴스를 사용하며 2vCPU를 가져 상대적으로 여유로운 성능을 가지고 있다. DBMS는 Oracle Oracle 12c Enterprise Edition을 사용하고 있다. 매일 오전 9시에 백업을 하여서 7일간 인스턴스 자체와 모든 설정 및 데이터를 자동으로 백업하는 시스템을 가지고 있어 안정성을 높였다. 또한 백석 마켓의 데이터베이스 로그는 매일 저녁 8시경 S3 스토리지에 모든 데이터를 보관하며 약 180일 가량을 저장하고 이후엔 삭제가 되도록 하였다. 이러한 강력한 하드웨어와 소프트웨어를 가진 데이터 베이스를 피시방 비용보다 200배 싼 가격으로 사용 할 수 있다.

1. AWS EBS 스냅샷을 사용한 수직 확장
------------------------------------------------------------------------------------------

<img src="https://raw.githubusercontent.com/dsg890789/JwsPortfolio/master/Django%20Framework%20Project/BuMarket%20AWS%20EBS%20Logo.png">

- AWS EBS는 Amazon Elastic Block Store의 약자로 대규모로 처리량과 트랜잭션 집약적인 워크로드 모두를 지원하기 위해 EC2에서 사용하도록 설계된 사용하기 쉬운 고성능 블록 스토리지 서비스이다. AWS EC2의 프로세스와 SSD는 물리적으로 분리되어 있으며 t3.micro 인스턴스를 사용하다가 CPU의 부하량이 일정 수준 이상 넘을 경우 개발자는 EBS 스토리지의 스냅샷을 저장한 후 EC2 인스턴스의 프로세스를 다른 프로세스로 변경이 가능하다. 즉 1vCPU 1GB의 t3.micro에서 m5d.24xlarge의 96개의 vCPU와 384GB의 엉청난 성능의 인스턴스로 손쉽게 변경 할 수 있다. 이것을 수직 확장이며 백석 마켓에서도 언제든지 적용이 가능한 옵션 이다.

1. AWS 로드밴런서를 사용한 수평 확장
------------------------------------------------------------------------------------------

<img src="https://raw.githubusercontent.com/dsg890789/JwsPortfolio/master/Django%20Framework%20Project/BuMarket%20AWS%20LoadBalance%203.png">
<img src="https://raw.githubusercontent.com/dsg890789/JwsPortfolio/master/Django%20Framework%20Project/BuMarket%20AWS%20LoadBalance%202.png">

- AWS 로드 밸런서란 클라우드의 특징 기능 중 하나이다. 기존의 온프라이미스 서버에서는 하나의 서버 패키지에는 최대 96개의 CPU와 192개의 스레드만 지원한다. 하지만 클라우드에서는 프로세스를 무한히 확장가능하다. 바로 AWS 로드 밸런서이다. 로드 밸런서를 이용하여 어플리케이션의 수요 변동에 따라 인프라가 빠르게 확장 하거나 축소 할 수 있도록 만들 수 있다. AWS 로드 밸런서를 사용 할때의 주의점으로는 GCP HTTP 로드 밸런스 보다 인스턴스의 생성시간에 몇 분이 걸림으로 로드 밸런서의 Health Check를 상대적으로 여유롭게 설정하는 편이 어플리케이션 장애 예방에 효과적이다.

1. AWS S3
------------------------------------------------------------------------------------------
- AWS S3

<img src="https://raw.githubusercontent.com/dsg890789/JwsPortfolio/master/Django%20Framework%20Project/BuMarket%20AWS%20EBS%20Logo.png">

- 데이터베이스 내부에 직접 이미지를 저장하는 방식은 데이터베이스의 처리량, 네트워크, 디스크 모든 자원에 대해서 부담을 가하며 비효율적인 방법이다. 기존의 온프라이미스 서버에서는 WAS에서 별도의 포트를 열어두어 파일의 입출력에 할당하는데 이러한 방식은 온프라이미스 서버에서는 상당한 부하를 가하는 방식이다. 하지만 AWS S3와 GCP Storage는 이러한 단점을 완전히 해결하기 위해 별도의  서비스를 생성하여 서버와 데이터베이스에 전혀 부하를 줄이는 방식을 사용하고 있다. 백석마ㄴ는 저장된 이미지의 주소값만 저장하도록 하였다. 이러한 방식을 통하여 대용량의 파일을 입출력하여도 서버와 데이터베이스는 항상 일정한 퍼포먼스를 유지 할 수 있도록 초기 설계에서부터 계획하여 구현하였다.

<img src="https://raw.githubusercontent.com/dsg890789/JwsPortfolio/master/Django%20Framework%20Project/BuMarket%20AWS%20EBS%20Log%Bucket.png">

- AWS S3를 통하여 로그를 저장하는 기능으로 사용 할 수 있도록 하였다. 2020년 1월에 추가한 기능으로 나의 Github 포트폴리오 페이지와 백석마켓에 HTTP 메소드를 내역을 모두 수집하여 자동으로 S3에 저장하도록 하였다. 무한히 그리고 영구히 저장하는 S3를 이용하여 서버내 발생되는 모든 로그를 저장하도록 하였다.